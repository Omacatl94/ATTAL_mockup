<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>Crea Articolo | ATTAL Blog Admin</title>

    <!-- CSS Standard del sito -->
    <link rel="stylesheet" href="../../assets/css/variables.css">
    <link rel="stylesheet" href="../../assets/css/base.css">
    <link rel="stylesheet" href="../../assets/css/components.css">

    <style>
        :root {
            --admin-primary: #e22721;
            --admin-primary-dark: #c91f1a;
            --admin-bg: #f3f4f6;
            --admin-card: #ffffff;
            --admin-border: #e5e7eb;
            --admin-text: #1f2937;
            --admin-text-light: #6b7280;
            --admin-success: #10b981;
            --admin-warning: #f59e0b;
            --admin-radius: 12px;
        }

        /* PAGE SPECIFIC */
        body {
            background: var(--admin-bg);
        }

        .btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
            text-decoration: none;
        }

        .btn-secondary {
            background: var(--admin-bg);
            color: var(--admin-text);
            border: 1px solid var(--admin-border);
        }

        .btn-secondary:hover {
            background: #e5e7eb;
        }

        .btn-primary {
            background: var(--admin-primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--admin-primary-dark);
        }

        .btn-success {
            background: var(--admin-success);
            color: white;
        }

        .btn-success:hover {
            background: #059669;
        }

        /* MAIN LAYOUT */
        .admin-main {
            display: grid;
            grid-template-columns: 1fr;
            gap: 24px;
            padding: 24px;
            max-width: 1600px;
            margin: 0 auto;
        }

        @media (min-width: 1200px) {
            .admin-main {
                grid-template-columns: 1fr 500px;
            }
        }

        /* CARDS */
        .admin-card {
            background: var(--admin-card);
            border-radius: var(--admin-radius);
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--admin-border);
        }

        .card-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 16px;
            font-weight: 600;
        }

        .card-title svg {
            color: var(--admin-primary);
        }

        /* FORM ELEMENTS */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: var(--admin-text);
            margin-bottom: 8px;
        }

        .form-label span {
            font-weight: 400;
            color: var(--admin-text-light);
        }

        .form-input,
        .form-textarea,
        .form-select {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid var(--admin-border);
            border-radius: 8px;
            font-size: 15px;
            transition: all 0.2s ease;
            background: white;
        }

        .form-input:focus,
        .form-textarea:focus,
        .form-select:focus {
            outline: none;
            border-color: var(--admin-primary);
            box-shadow: 0 0 0 3px rgba(226, 39, 33, 0.1);
        }

        .form-textarea {
            min-height: 150px;
            resize: vertical;
            font-family: inherit;
        }

        .form-hint {
            font-size: 12px;
            color: var(--admin-text-light);
            margin-top: 6px;
        }

        .char-count {
            text-align: right;
            font-size: 12px;
            color: var(--admin-text-light);
        }

        .char-count.warning { color: var(--admin-warning); }
        .char-count.error { color: var(--admin-primary); }

        /* FORM ROW */
        .form-row {
            display: grid;
            grid-template-columns: 1fr;
            gap: 16px;
        }

        @media (min-width: 640px) {
            .form-row-2 { grid-template-columns: repeat(2, 1fr); }
            .form-row-3 { grid-template-columns: repeat(3, 1fr); }
        }

        /* TAGS INPUT */
        .tags-input-wrapper {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            padding: 8px 12px;
            border: 1px solid var(--admin-border);
            border-radius: 8px;
            min-height: 48px;
            cursor: text;
        }

        .tags-input-wrapper:focus-within {
            border-color: var(--admin-primary);
            box-shadow: 0 0 0 3px rgba(226, 39, 33, 0.1);
        }

        .tag {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            background: #fef2f2;
            border-radius: 6px;
            font-size: 13px;
            color: var(--admin-primary);
        }

        .tag-remove {
            cursor: pointer;
            opacity: 0.6;
        }

        .tag-remove:hover { opacity: 1; }

        .tags-input {
            flex: 1;
            min-width: 100px;
            border: none;
            outline: none;
            font-size: 14px;
            padding: 4px;
        }

        /* IMAGE SEARCH */
        .image-search-section {
            margin-bottom: 20px;
        }

        .image-search-bar {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
        }

        .image-search-bar input {
            flex: 1;
        }

        .image-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            max-height: 300px;
            overflow-y: auto;
        }

        .image-option {
            aspect-ratio: 16/10;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.2s ease;
        }

        .image-option:hover {
            transform: scale(1.02);
        }

        .image-option.selected {
            border-color: var(--admin-primary);
        }

        .image-option img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .selected-image-preview {
            margin-top: 16px;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }

        .selected-image-preview img {
            width: 100%;
            height: auto;
        }

        .selected-image-info {
            padding: 12px;
            background: var(--admin-bg);
            font-size: 13px;
            color: var(--admin-text-light);
        }

        /* TABS */
        .tabs {
            display: flex;
            gap: 4px;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--admin-border);
        }

        .tab-btn {
            padding: 12px 20px;
            background: none;
            border: none;
            font-size: 14px;
            font-weight: 500;
            color: var(--admin-text-light);
            cursor: pointer;
            border-bottom: 2px solid transparent;
            margin-bottom: -1px;
            transition: all 0.2s ease;
        }

        .tab-btn:hover {
            color: var(--admin-text);
        }

        .tab-btn.active {
            color: var(--admin-primary);
            border-bottom-color: var(--admin-primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* PREVIEW */
        .preview-container {
            background: white;
            border-radius: var(--admin-radius);
            overflow: hidden;
        }

        .preview-header {
            padding: 16px;
            background: var(--admin-bg);
            border-bottom: 1px solid var(--admin-border);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .preview-title {
            font-size: 14px;
            font-weight: 600;
        }

        .preview-mode-toggle {
            display: flex;
            gap: 4px;
            background: white;
            border-radius: 6px;
            padding: 4px;
        }

        .preview-mode-btn {
            padding: 6px 12px;
            border: none;
            background: none;
            font-size: 12px;
            cursor: pointer;
            border-radius: 4px;
        }

        .preview-mode-btn.active {
            background: var(--admin-primary);
            color: white;
        }

        .preview-frame {
            width: 100%;
            min-height: 600px;
            border: none;
            background: white;
        }

        .preview-content {
            padding: 24px;
            max-height: 700px;
            overflow-y: auto;
        }

        /* SEO PREVIEW */
        .seo-preview {
            padding: 16px;
            background: white;
            border-radius: 8px;
            border: 1px solid var(--admin-border);
        }

        .seo-preview-url {
            font-size: 12px;
            color: #1a73e8;
            margin-bottom: 4px;
        }

        .seo-preview-title {
            font-size: 18px;
            color: #1a0dab;
            margin-bottom: 4px;
            line-height: 1.3;
        }

        .seo-preview-desc {
            font-size: 14px;
            color: #545454;
            line-height: 1.5;
        }

        /* EDITOR TOOLBAR */
        .editor-toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            padding: 8px;
            background: var(--admin-bg);
            border-radius: 8px 8px 0 0;
            border: 1px solid var(--admin-border);
            border-bottom: none;
        }

        .editor-btn {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            border: 1px solid var(--admin-border);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .editor-btn:hover {
            background: var(--admin-primary);
            border-color: var(--admin-primary);
            color: white;
        }

        .editor-btn svg {
            width: 18px;
            height: 18px;
        }

        .editor-divider {
            width: 1px;
            height: 36px;
            background: var(--admin-border);
            margin: 0 4px;
        }

        .form-textarea.with-toolbar {
            border-radius: 0 0 8px 8px;
            border-top: none;
        }

        /* MODAL */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.2s ease;
        }

        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: white;
            border-radius: var(--admin-radius);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .modal-header {
            padding: 20px 24px;
            border-bottom: 1px solid var(--admin-border);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
        }

        .modal-close {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: none;
            border: none;
            cursor: pointer;
            border-radius: 8px;
        }

        .modal-close:hover {
            background: var(--admin-bg);
        }

        .modal-body {
            padding: 24px;
            overflow-y: auto;
            flex: 1;
        }

        .modal-footer {
            padding: 16px 24px;
            border-top: 1px solid var(--admin-border);
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }

        /* CODE OUTPUT */
        .code-output {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 12px;
            line-height: 1.6;
            overflow-x: auto;
            max-height: 500px;
            overflow-y: auto;
        }

        /* TOAST NOTIFICATION */
        .toast {
            position: fixed;
            bottom: 24px;
            right: 24px;
            padding: 16px 20px;
            background: var(--admin-text);
            color: white;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 2000;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        .toast.success { background: var(--admin-success); }
        .toast.error { background: var(--admin-primary); }

        /* CHECKBOX */
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .checkbox-input {
            width: 20px;
            height: 20px;
            accent-color: var(--admin-primary);
        }

        .checkbox-label {
            font-size: 14px;
            color: var(--admin-text);
        }

        /* STATUS INDICATOR */
        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-draft {
            background: #fef3c7;
            color: #d97706;
        }

        .status-ready {
            background: #d1fae5;
            color: #059669;
        }

        /* LOADING */
        .loading-spinner {
            width: 20px;
            height: 20px;
            border: 2px solid #e5e7eb;
            border-top-color: var(--admin-primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ADMIN TOOLBAR */
        .admin-toolbar {
            background: white;
            border-bottom: 1px solid var(--admin-border);
            padding: 16px 0;
            position: sticky;
            top: 70px;
            z-index: 90;
        }

        .admin-toolbar-inner {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
            flex-wrap: wrap;
        }

        .admin-back {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 14px;
            color: var(--admin-text-light);
            text-decoration: none;
        }

        .admin-back:hover {
            color: var(--admin-primary);
        }

        .admin-back svg {
            width: 20px;
            height: 20px;
        }

        .admin-toolbar-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 18px;
            font-weight: 600;
        }

        .admin-toolbar-title svg {
            width: 20px;
            height: 20px;
            color: var(--admin-primary);
        }

        .admin-toolbar-actions {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        @media (max-width: 768px) {
            .admin-toolbar-title {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- Header Standard -->
    <div id="header-placeholder"></div>

    <!-- ADMIN TOOLBAR -->
    <div class="admin-toolbar">
        <div class="container">
            <div class="admin-toolbar-inner">
                <a href="../blog.html" class="admin-back">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"></polyline></svg>
                    Torna al Blog
                </a>
                <div class="admin-toolbar-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>
                    Crea Nuovo Articolo
                </div>
                <div class="admin-toolbar-actions">
                    <span class="status-indicator status-draft" id="articleStatus">Bozza</span>
                    <button class="btn btn-secondary" onclick="previewArticle()">Preview</button>
                    <button class="btn btn-primary" onclick="generateArticle()">Genera HTML</button>
                </div>
            </div>
        </div>
    </div>

    <!-- MAIN -->
    <main class="admin-main">
        <!-- LEFT COLUMN - EDITOR -->
        <div class="editor-column">
            <!-- BASIC INFO -->
            <div class="admin-card">
                <div class="card-header">
                    <div class="card-title">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>
                        Informazioni Base
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Titolo Articolo <span>(H1)</span></label>
                    <input type="text" class="form-input" id="articleTitle" placeholder="es. Come Trovare Lavoro nel 2025: Guida Completa" oninput="updatePreviews()">
                    <div class="char-count"><span id="titleCount">0</span>/60 caratteri</div>
                </div>

                <div class="form-group">
                    <label class="form-label">Slug URL</label>
                    <input type="text" class="form-input" id="articleSlug" placeholder="come-trovare-lavoro-2025" oninput="updatePreviews()">
                    <div class="form-hint">Solo lettere minuscole, numeri e trattini. Verrà generato automaticamente dal titolo.</div>
                </div>

                <div class="form-row form-row-2">
                    <div class="form-group">
                        <label class="form-label">Categoria</label>
                        <select class="form-select" id="articleCategory">
                            <option value="lavoro">Lavoro</option>
                            <option value="normative">Normative</option>
                            <option value="news-azienda">News Azienda</option>
                            <option value="eventi">Eventi</option>
                            <option value="consigli-candidati">Per Candidati</option>
                            <option value="per-aziende">Per Aziende</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Autore</label>
                        <select class="form-select" id="articleAuthor">
                            <option value="marco-bianchi">Marco Bianchi - HR Manager</option>
                            <option value="giulia-rossi">Giulia Rossi - Content Specialist</option>
                            <option value="luca-ferrari">Luca Ferrari - Recruiter Senior</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Excerpt / Descrizione breve</label>
                    <textarea class="form-textarea" id="articleExcerpt" rows="3" placeholder="Breve descrizione che apparirà nella lista articoli e nei risultati di ricerca..." oninput="updatePreviews()"></textarea>
                    <div class="char-count"><span id="excerptCount">0</span>/160 caratteri</div>
                </div>

                <div class="form-group">
                    <label class="form-label">Tags</label>
                    <div class="tags-input-wrapper" onclick="document.getElementById('tagsInput').focus()">
                        <div id="tagsContainer"></div>
                        <input type="text" class="tags-input" id="tagsInput" placeholder="Aggiungi tag e premi Enter">
                    </div>
                    <div class="form-hint">Premi Enter per aggiungere un tag</div>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" class="checkbox-input" id="articleFeatured">
                    <label class="checkbox-label" for="articleFeatured">Articolo in evidenza (mostrato per primo)</label>
                </div>
            </div>

            <!-- HERO IMAGE -->
            <div class="admin-card">
                <div class="card-header">
                    <div class="card-title">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg>
                        Immagine Hero
                    </div>
                </div>

                <div class="tabs">
                    <button class="tab-btn active" data-tab="unsplash">Cerca su Unsplash</button>
                    <button class="tab-btn" data-tab="url">URL Immagine</button>
                    <button class="tab-btn" data-tab="upload">Carica File</button>
                </div>

                <div class="tab-content active" id="tab-unsplash">
                    <div class="image-search-bar">
                        <input type="text" class="form-input" id="unsplashSearch" placeholder="Cerca immagini (es. office, work, business)">
                        <button class="btn btn-primary" onclick="searchUnsplash()">Cerca</button>
                    </div>
                    <div class="image-grid" id="unsplashResults">
                        <!-- Images loaded here -->
                    </div>
                </div>

                <div class="tab-content" id="tab-url">
                    <div class="form-group">
                        <label class="form-label">URL Immagine</label>
                        <input type="text" class="form-input" id="imageUrl" placeholder="https://example.com/image.jpg" oninput="loadImageFromUrl()">
                    </div>
                </div>

                <div class="tab-content" id="tab-upload">
                    <div class="form-group">
                        <input type="file" id="imageUpload" accept="image/*" onchange="handleImageUpload(event)" style="display:none">
                        <button class="btn btn-secondary" onclick="document.getElementById('imageUpload').click()" style="width:100%">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>
                            Carica immagine
                        </button>
                        <div class="form-hint">Dimensione consigliata: 1200x675px (16:9)</div>
                    </div>
                </div>

                <div class="selected-image-preview" id="selectedImagePreview" style="display:none">
                    <img src="" alt="Selected image" id="previewImage">
                    <div class="selected-image-info">
                        <div class="form-group" style="margin-bottom:8px">
                            <input type="text" class="form-input" id="imageAlt" placeholder="Descrizione immagine (alt text)">
                        </div>
                        <div class="form-group" style="margin-bottom:0">
                            <input type="text" class="form-input" id="imageCaption" placeholder="Didascalia (opzionale)">
                        </div>
                    </div>
                </div>
            </div>

            <!-- CONTENT -->
            <div class="admin-card">
                <div class="card-header">
                    <div class="card-title">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line></svg>
                        Contenuto Articolo
                    </div>
                </div>

                <div class="editor-toolbar">
                    <button class="editor-btn" onclick="insertMarkdown('## ', '')" title="Heading 2">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 12h8m-8 6V6m8 12V6m4 0v12m4-6h-4"></path></svg>
                    </button>
                    <button class="editor-btn" onclick="insertMarkdown('### ', '')" title="Heading 3">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 12h8m-8 6V6m8 12V6m4 0v6m4-6v6m-4 0h4m-2 0v6"></path></svg>
                    </button>
                    <div class="editor-divider"></div>
                    <button class="editor-btn" onclick="insertMarkdown('**', '**')" title="Grassetto">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 4h8a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"></path><path d="M6 12h9a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"></path></svg>
                    </button>
                    <button class="editor-btn" onclick="insertMarkdown('*', '*')" title="Corsivo">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="19" y1="4" x2="10" y2="4"></line><line x1="14" y1="20" x2="5" y2="20"></line><line x1="15" y1="4" x2="9" y2="20"></line></svg>
                    </button>
                    <div class="editor-divider"></div>
                    <button class="editor-btn" onclick="insertMarkdown('- ', '')" title="Lista puntata">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><circle cx="4" cy="6" r="1" fill="currentColor"></circle><circle cx="4" cy="12" r="1" fill="currentColor"></circle><circle cx="4" cy="18" r="1" fill="currentColor"></circle></svg>
                    </button>
                    <button class="editor-btn" onclick="insertMarkdown('1. ', '')" title="Lista numerata">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="10" y1="6" x2="21" y2="6"></line><line x1="10" y1="12" x2="21" y2="12"></line><line x1="10" y1="18" x2="21" y2="18"></line><text x="3" y="8" font-size="6" fill="currentColor">1</text><text x="3" y="14" font-size="6" fill="currentColor">2</text><text x="3" y="20" font-size="6" fill="currentColor">3</text></svg>
                    </button>
                    <div class="editor-divider"></div>
                    <button class="editor-btn" onclick="insertMarkdown('[', '](url)')" title="Link">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg>
                    </button>
                    <button class="editor-btn" onclick="insertMarkdown('> ', '')" title="Citazione">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V21"></path><path d="M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2h.75c0 2.25.25 4-2.75 4v3"></path></svg>
                    </button>
                </div>
                <textarea class="form-textarea with-toolbar" id="articleContent" rows="20" placeholder="Scrivi il contenuto dell'articolo...

## Introduzione
Inizia con un hook che cattura l'attenzione...

## Sezione 1
Contenuto della prima sezione...

## Sezione 2
Contenuto della seconda sezione...

## Conclusione
Riassumi i punti chiave..."></textarea>
            </div>

            <!-- FAQ SECTION -->
            <div class="admin-card">
                <div class="card-header">
                    <div class="card-title">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
                        FAQ (Domande Frequenti)
                    </div>
                    <button class="btn btn-secondary" onclick="addFaq()">+ Aggiungi FAQ</button>
                </div>

                <div id="faqContainer">
                    <!-- FAQ items added dynamically -->
                </div>
            </div>
        </div>

        <!-- RIGHT COLUMN - PREVIEW -->
        <div class="preview-column">
            <!-- SEO PREVIEW -->
            <div class="admin-card">
                <div class="card-header">
                    <div class="card-title">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                        Anteprima Google
                    </div>
                </div>

                <div class="seo-preview">
                    <div class="seo-preview-url" id="seoUrl">attalgroup.it/pages/blog/...</div>
                    <div class="seo-preview-title" id="seoTitle">Titolo dell'articolo | ATTAL Group</div>
                    <div class="seo-preview-desc" id="seoDesc">Descrizione dell'articolo che apparirà nei risultati di ricerca...</div>
                </div>

                <div class="form-group" style="margin-top: 16px;">
                    <label class="form-label">Meta Title <span>(opzionale, usa titolo se vuoto)</span></label>
                    <input type="text" class="form-input" id="metaTitle" placeholder="Titolo per Google (max 60 caratteri)" oninput="updatePreviews()">
                </div>

                <div class="form-group">
                    <label class="form-label">Meta Description <span>(opzionale, usa excerpt se vuoto)</span></label>
                    <textarea class="form-textarea" id="metaDescription" rows="2" placeholder="Descrizione per Google (max 160 caratteri)" oninput="updatePreviews()"></textarea>
                </div>
            </div>

            <!-- ARTICLE PREVIEW -->
            <div class="admin-card" style="padding:0; overflow:hidden;">
                <div class="preview-header">
                    <span class="preview-title">Anteprima Articolo</span>
                </div>
                <div class="preview-content" id="articlePreview">
                    <p style="color: #9ca3af; text-align: center; padding: 40px 0;">
                        Compila i campi per vedere l'anteprima...
                    </p>
                </div>
            </div>
        </div>
    </main>

    <!-- MODAL - HTML OUTPUT -->
    <div class="modal-overlay" id="htmlModal">
        <div class="modal">
            <div class="modal-header">
                <span class="modal-title">HTML Generato</span>
                <button class="modal-close" onclick="closeModal()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                </button>
            </div>
            <div class="modal-body">
                <pre class="code-output" id="htmlOutput"></pre>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="downloadHtml()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
                    Scarica HTML
                </button>
                <button class="btn btn-secondary" onclick="downloadJson()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline></svg>
                    Scarica JSON
                </button>
                <button class="btn btn-primary" onclick="copyHtml()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    Copia HTML
                </button>
            </div>
        </div>
    </div>

    <!-- TOAST -->
    <div class="toast" id="toast">
        <span id="toastMessage"></span>
    </div>

    <script>
        // ============================================
        // DATA & STATE
        // ============================================

        const authors = {
            'marco-bianchi': {
                name: 'Marco Bianchi',
                role: 'HR Manager',
                avatar: 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=100&h=100&fit=crop&crop=face',
                bio: 'HR Manager con oltre 15 anni di esperienza nel settore delle risorse umane.'
            },
            'giulia-rossi': {
                name: 'Giulia Rossi',
                role: 'Content Specialist',
                avatar: 'https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=100&h=100&fit=crop&crop=face',
                bio: 'Content Specialist specializzata in comunicazione aziendale e employer branding.'
            },
            'luca-ferrari': {
                name: 'Luca Ferrari',
                role: 'Recruiter Senior',
                avatar: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=100&h=100&fit=crop&crop=face',
                bio: 'Recruiter Senior con esperienza in selezione per aziende di ogni settore.'
            }
        };

        const categoryLabels = {
            'lavoro': 'Lavoro',
            'normative': 'Normative',
            'news-azienda': 'News Azienda',
            'eventi': 'Eventi',
            'consigli-candidati': 'Per Candidati',
            'per-aziende': 'Per Aziende'
        };

        let articleData = {
            tags: [],
            faqs: [],
            heroImage: null
        };

        let generatedHtml = '';
        let generatedJson = {};

        // ============================================
        // INITIALIZATION
        // ============================================

        document.addEventListener('DOMContentLoaded', () => {
            // Tabs
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const tab = btn.dataset.tab;
                    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    btn.classList.add('active');
                    document.getElementById(`tab-${tab}`).classList.add('active');
                });
            });

            // Tags input
            document.getElementById('tagsInput').addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    const value = e.target.value.trim();
                    if (value && !articleData.tags.includes(value)) {
                        articleData.tags.push(value);
                        renderTags();
                    }
                    e.target.value = '';
                }
            });

            // Auto-generate slug
            document.getElementById('articleTitle').addEventListener('input', (e) => {
                const slug = generateSlug(e.target.value);
                document.getElementById('articleSlug').value = slug;
                updatePreviews();
            });

            // Character counters
            setupCharCounter('articleTitle', 'titleCount', 60);
            setupCharCounter('articleExcerpt', 'excerptCount', 160);

            // Load sample images
            loadSampleImages();
        });

        // ============================================
        // HELPER FUNCTIONS
        // ============================================

        function generateSlug(text) {
            return text
                .toLowerCase()
                .replace(/[àáâãäå]/g, 'a')
                .replace(/[èéêë]/g, 'e')
                .replace(/[ìíîï]/g, 'i')
                .replace(/[òóôõö]/g, 'o')
                .replace(/[ùúûü]/g, 'u')
                .replace(/[^a-z0-9\s-]/g, '')
                .replace(/\s+/g, '-')
                .replace(/-+/g, '-')
                .substring(0, 60);
        }

        function setupCharCounter(inputId, countId, maxChars) {
            const input = document.getElementById(inputId);
            const count = document.getElementById(countId);

            input.addEventListener('input', () => {
                const len = input.value.length;
                count.textContent = len;
                count.parentElement.classList.remove('warning', 'error');
                if (len > maxChars) count.parentElement.classList.add('error');
                else if (len > maxChars * 0.9) count.parentElement.classList.add('warning');
            });
        }

        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const msg = document.getElementById('toastMessage');
            msg.textContent = message;
            toast.className = `toast ${type} show`;
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        // ============================================
        // TAGS
        // ============================================

        function renderTags() {
            const container = document.getElementById('tagsContainer');
            container.innerHTML = articleData.tags.map((tag, i) => `
                <span class="tag">
                    ${tag}
                    <span class="tag-remove" onclick="removeTag(${i})">×</span>
                </span>
            `).join('');
        }

        function removeTag(index) {
            articleData.tags.splice(index, 1);
            renderTags();
        }

        // ============================================
        // FAQ
        // ============================================

        function addFaq() {
            const container = document.getElementById('faqContainer');
            const index = articleData.faqs.length;
            articleData.faqs.push({ question: '', answer: '' });

            const faqHtml = `
                <div class="faq-item-edit" data-index="${index}">
                    <div class="form-group">
                        <label class="form-label">Domanda ${index + 1}</label>
                        <input type="text" class="form-input" placeholder="es. Qual è la durata del contratto?" onchange="updateFaq(${index}, 'question', this.value)">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Risposta</label>
                        <textarea class="form-textarea" rows="3" placeholder="Risposta alla domanda..." onchange="updateFaq(${index}, 'answer', this.value)"></textarea>
                    </div>
                    <button class="btn btn-secondary" onclick="removeFaq(${index})" style="margin-bottom:16px">Rimuovi FAQ</button>
                </div>
            `;
            container.insertAdjacentHTML('beforeend', faqHtml);
        }

        function updateFaq(index, field, value) {
            articleData.faqs[index][field] = value;
        }

        function removeFaq(index) {
            articleData.faqs.splice(index, 1);
            document.getElementById('faqContainer').innerHTML = '';
            articleData.faqs.forEach((faq, i) => {
                addFaq();
                const item = document.querySelector(`.faq-item-edit[data-index="${i}"]`);
                item.querySelector('input').value = faq.question;
                item.querySelector('textarea').value = faq.answer;
            });
        }

        // ============================================
        // IMAGES
        // ============================================

        const UNSPLASH_ACCESS_KEY = 'YOUR_UNSPLASH_ACCESS_KEY'; // Replace with your key

        function loadSampleImages() {
            const sampleImages = [
                'https://images.unsplash.com/photo-1497366216548-37526070297c?w=400',
                'https://images.unsplash.com/photo-1497215842964-222b430dc094?w=400',
                'https://images.unsplash.com/photo-1454165804606-c3d57bc86b40?w=400',
                'https://images.unsplash.com/photo-1521737711867-e3b97375f902?w=400',
                'https://images.unsplash.com/photo-1552664730-d307ca884978?w=400',
                'https://images.unsplash.com/photo-1600880292203-757bb62b4baf?w=400'
            ];

            const grid = document.getElementById('unsplashResults');
            grid.innerHTML = sampleImages.map(url => `
                <div class="image-option" onclick="selectImage('${url.replace('w=400', 'w=1200')}', this)">
                    <img src="${url}" alt="Sample image" loading="lazy">
                </div>
            `).join('');
        }

        async function searchUnsplash() {
            const query = document.getElementById('unsplashSearch').value;
            if (!query) return;

            const grid = document.getElementById('unsplashResults');
            grid.innerHTML = '<p style="text-align:center;color:#9ca3af;grid-column:1/-1;padding:20px">Ricerca in corso...</p>';

            // Using Unsplash Source (no API key needed for demo)
            const images = [];
            for (let i = 0; i < 9; i++) {
                images.push(`https://source.unsplash.com/800x600/?${encodeURIComponent(query)}&sig=${i}`);
            }

            grid.innerHTML = images.map(url => `
                <div class="image-option" onclick="selectImage('${url.replace('800x600', '1200x675')}', this)">
                    <img src="${url}" alt="${query}" loading="lazy">
                </div>
            `).join('');
        }

        function selectImage(url, element) {
            document.querySelectorAll('.image-option').forEach(el => el.classList.remove('selected'));
            if (element) element.classList.add('selected');

            articleData.heroImage = {
                url: url,
                alt: '',
                caption: ''
            };

            document.getElementById('selectedImagePreview').style.display = 'block';
            document.getElementById('previewImage').src = url;
            updatePreviews();
        }

        function loadImageFromUrl() {
            const url = document.getElementById('imageUrl').value;
            if (url) selectImage(url, null);
        }

        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                selectImage(e.target.result, null);
            };
            reader.readAsDataURL(file);
        }

        // ============================================
        // EDITOR
        // ============================================

        function insertMarkdown(before, after) {
            const textarea = document.getElementById('articleContent');
            const start = textarea.selectionStart;
            const end = textarea.selectionEnd;
            const text = textarea.value;
            const selected = text.substring(start, end);

            textarea.value = text.substring(0, start) + before + selected + after + text.substring(end);
            textarea.focus();
            textarea.selectionStart = textarea.selectionEnd = start + before.length + selected.length + after.length;
        }

        // ============================================
        // PREVIEWS
        // ============================================

        function updatePreviews() {
            const title = document.getElementById('articleTitle').value || 'Titolo articolo';
            const slug = document.getElementById('articleSlug').value || 'slug-articolo';
            const excerpt = document.getElementById('articleExcerpt').value || 'Descrizione dell\'articolo...';
            const metaTitle = document.getElementById('metaTitle').value || title;
            const metaDesc = document.getElementById('metaDescription').value || excerpt;

            // SEO Preview
            document.getElementById('seoUrl').textContent = `attalgroup.it/pages/blog/${slug}.html`;
            document.getElementById('seoTitle').textContent = `${metaTitle} | ATTAL Group`.substring(0, 65);
            document.getElementById('seoDesc').textContent = metaDesc.substring(0, 160);

            // Article Preview
            updateArticlePreview();

            // Status
            const status = document.getElementById('articleStatus');
            if (title.length > 5 && excerpt.length > 10 && articleData.heroImage) {
                status.textContent = 'Pronto';
                status.className = 'status-indicator status-ready';
            } else {
                status.textContent = 'Bozza';
                status.className = 'status-indicator status-draft';
            }
        }

        function updateArticlePreview() {
            const title = document.getElementById('articleTitle').value;
            const excerpt = document.getElementById('articleExcerpt').value;
            const content = document.getElementById('articleContent').value;
            const category = document.getElementById('articleCategory').value;
            const authorKey = document.getElementById('articleAuthor').value;
            const author = authors[authorKey];

            const imageAlt = document.getElementById('imageAlt')?.value || '';
            articleData.heroImage && (articleData.heroImage.alt = imageAlt);
            articleData.heroImage && (articleData.heroImage.caption = document.getElementById('imageCaption')?.value || '');

            const preview = document.getElementById('articlePreview');

            if (!title) {
                preview.innerHTML = '<p style="color: #9ca3af; text-align: center; padding: 40px 0;">Compila i campi per vedere l\'anteprima...</p>';
                return;
            }

            // Simple markdown to HTML
            let htmlContent = content
                .replace(/^### (.*$)/gim, '<h3>$1</h3>')
                .replace(/^## (.*$)/gim, '<h2>$1</h2>')
                .replace(/^\* (.*$)/gim, '<li>$1</li>')
                .replace(/^- (.*$)/gim, '<li>$1</li>')
                .replace(/^\d+\. (.*$)/gim, '<li>$1</li>')
                .replace(/\*\*(.*)\*\*/gim, '<strong>$1</strong>')
                .replace(/\*(.*)\*/gim, '<em>$1</em>')
                .replace(/^> (.*$)/gim, '<blockquote>$1</blockquote>')
                .replace(/\n\n/g, '</p><p>')
                .replace(/\n/g, '<br>');

            htmlContent = `<p>${htmlContent}</p>`;

            preview.innerHTML = `
                <span style="display:inline-block;padding:4px 10px;background:#fef2f2;color:#e22721;border-radius:4px;font-size:12px;font-weight:600;text-transform:uppercase;margin-bottom:12px">${categoryLabels[category]}</span>
                <h1 style="font-size:24px;font-weight:700;line-height:1.3;margin-bottom:16px">${title}</h1>
                <div style="display:flex;align-items:center;gap:12px;margin-bottom:20px;padding-bottom:16px;border-bottom:1px solid #e5e7eb">
                    <img src="${author.avatar}" alt="${author.name}" style="width:40px;height:40px;border-radius:50%;object-fit:cover">
                    <div>
                        <div style="font-weight:600;font-size:14px">${author.name}</div>
                        <div style="font-size:12px;color:#6b7280">${author.role} • ${new Date().toLocaleDateString('it-IT', {day:'numeric',month:'long',year:'numeric'})}</div>
                    </div>
                </div>
                ${articleData.heroImage ? `<img src="${articleData.heroImage.url}" alt="${imageAlt}" style="width:100%;border-radius:12px;margin-bottom:20px">` : ''}
                <div style="font-size:16px;line-height:1.8;color:#374151">${htmlContent}</div>
            `;
        }

        function previewArticle() {
            updateArticlePreview();
            showToast('Anteprima aggiornata');
        }

        // ============================================
        // GENERATE HTML
        // ============================================

        function generateArticle() {
            const title = document.getElementById('articleTitle').value;
            const slug = document.getElementById('articleSlug').value;
            const excerpt = document.getElementById('articleExcerpt').value;
            const content = document.getElementById('articleContent').value;
            const category = document.getElementById('articleCategory').value;
            const authorKey = document.getElementById('articleAuthor').value;
            const author = authors[authorKey];
            const metaTitle = document.getElementById('metaTitle').value || title;
            const metaDesc = document.getElementById('metaDescription').value || excerpt;
            const featured = document.getElementById('articleFeatured').checked;
            const imageAlt = document.getElementById('imageAlt')?.value || title;
            const imageCaption = document.getElementById('imageCaption')?.value || '';

            if (!title || !slug || !excerpt || !content) {
                showToast('Compila tutti i campi obbligatori', 'error');
                return;
            }

            const now = new Date().toISOString();
            const wordCount = content.split(/\s+/).length;
            const readingTime = Math.ceil(wordCount / 200);

            // Generate JSON for blog-posts.json
            generatedJson = {
                id: slug,
                slug: slug,
                title: title,
                excerpt: excerpt,
                content: '',
                category: category,
                author: {
                    name: author.name,
                    role: author.role,
                    avatar: author.avatar
                },
                heroImage: {
                    url: articleData.heroImage?.url || '',
                    alt: imageAlt,
                    caption: imageCaption
                },
                datePublished: now,
                dateModified: now,
                readingTime: readingTime,
                tags: articleData.tags,
                featured: featured,
                status: 'published'
            };

            // Convert markdown to HTML
            let htmlContent = content
                .replace(/^### (.*$)/gim, '<h3 id="$1">$1</h3>')
                .replace(/^## (.*$)/gim, '<h2 id="$1">$1</h2>')
                .replace(/^\* (.*$)/gim, '<li>$1</li>')
                .replace(/^- (.*$)/gim, '<li>$1</li>')
                .replace(/^\d+\. (.*$)/gim, '<li>$1</li>')
                .replace(/\*\*(.*?)\*\*/gim, '<strong>$1</strong>')
                .replace(/\*(.*?)\*/gim, '<em>$1</em>')
                .replace(/^> (.*$)/gim, '<blockquote>$1</blockquote>')
                .replace(/\[([^\]]+)\]\(([^)]+)\)/gim, '<a href="$2" target="_blank" rel="noopener">$1</a>')
                .replace(/\n\n/g, '</p>\n<p>')
                .replace(/(<li>.*<\/li>)/s, '<ul>$1</ul>');

            htmlContent = `<p>${htmlContent}</p>`;

            // Generate FAQ HTML and Schema
            let faqHtml = '';
            let faqSchema = '';
            if (articleData.faqs.length > 0) {
                faqHtml = `
                <section class="faq-section" id="faq">
                    <h2>Domande Frequenti</h2>
                    ${articleData.faqs.map(faq => `
                    <div class="faq-item">
                        <h3>${faq.question}</h3>
                        <p>${faq.answer}</p>
                    </div>
                    `).join('')}
                </section>`;

                faqSchema = `,
        {
            "@type": "FAQPage",
            "@id": "https://www.attalgroup.it/pages/blog/${slug}.html#faq",
            "mainEntity": [
                ${articleData.faqs.map(faq => `{
                    "@type": "Question",
                    "name": "${faq.question.replace(/"/g, '\\"')}",
                    "acceptedAnswer": {
                        "@type": "Answer",
                        "text": "${faq.answer.replace(/"/g, '\\"')}"
                    }
                }`).join(',\n                ')}
            ]
        }`;
            }

            // Generate full HTML
            generatedHtml = `<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, max-image-preview:large">

    <!-- SEO Meta Tags -->
    <title>${metaTitle} | ATTAL Group</title>
    <meta name="description" content="${metaDesc}">
    <link rel="canonical" href="https://www.attalgroup.it/pages/blog/${slug}.html">

    <!-- Open Graph -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://www.attalgroup.it/pages/blog/${slug}.html">
    <meta property="og:title" content="${metaTitle}">
    <meta property="og:description" content="${metaDesc}">
    <meta property="og:image" content="${articleData.heroImage?.url || ''}">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="675">
    <meta property="og:locale" content="it_IT">
    <meta property="article:published_time" content="${now}">
    <meta property="article:modified_time" content="${now}">
    <meta property="article:author" content="${author.name}">
    <meta property="article:section" content="${categoryLabels[category]}">
    ${articleData.tags.map(tag => `<meta property="article:tag" content="${tag}">`).join('\n    ')}

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="${metaTitle}">
    <meta name="twitter:description" content="${metaDesc}">
    <meta name="twitter:image" content="${articleData.heroImage?.url || ''}">

    <!-- Styles -->
    <link rel="stylesheet" href="../../assets/css/variables.css">
    <link rel="stylesheet" href="../../assets/css/base.css">
    <link rel="stylesheet" href="../../assets/css/components.css">
    <link rel="stylesheet" href="../../assets/css/pages/blog.css">

    <!-- Schema.org JSON-LD -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@graph": [
            {
                "@type": "BlogPosting",
                "@id": "https://www.attalgroup.it/pages/blog/${slug}.html#article",
                "mainEntityOfPage": {
                    "@type": "WebPage",
                    "@id": "https://www.attalgroup.it/pages/blog/${slug}.html"
                },
                "headline": "${title.replace(/"/g, '\\"')}",
                "description": "${metaDesc.replace(/"/g, '\\"')}",
                "image": {
                    "@type": "ImageObject",
                    "url": "${articleData.heroImage?.url || ''}",
                    "width": 1200,
                    "height": 675
                },
                "datePublished": "${now}",
                "dateModified": "${now}",
                "author": {
                    "@type": "Person",
                    "name": "${author.name}",
                    "url": "https://www.attalgroup.it/chi-siamo",
                    "jobTitle": "${author.role}"
                },
                "publisher": {
                    "@type": "Organization",
                    "name": "ATTAL Group",
                    "logo": {
                        "@type": "ImageObject",
                        "url": "https://www.attalgroup.it/assets/images/attal-logo.png"
                    }
                },
                "wordCount": ${wordCount},
                "articleSection": "${categoryLabels[category]}",
                "keywords": "${articleData.tags.join(', ')}",
                "inLanguage": "it-IT"
            },
            {
                "@type": "BreadcrumbList",
                "@id": "https://www.attalgroup.it/pages/blog/${slug}.html#breadcrumb",
                "itemListElement": [
                    {
                        "@type": "ListItem",
                        "position": 1,
                        "name": "Home",
                        "item": "https://www.attalgroup.it"
                    },
                    {
                        "@type": "ListItem",
                        "position": 2,
                        "name": "Blog",
                        "item": "https://www.attalgroup.it/pages/blog.html"
                    },
                    {
                        "@type": "ListItem",
                        "position": 3,
                        "name": "${title.replace(/"/g, '\\"')}"
                    }
                ]
            }${faqSchema}
        ]
    }
    </script>
</head>
<body>
    <!-- Skip Link -->
    <a href="#main-content" class="skip-link">Vai al contenuto principale</a>

    <!-- Reading Progress Bar -->
    <div class="reading-progress" id="readingProgress"></div>

    <!-- Header -->
    <div id="header-placeholder"></div>

    <!-- HERO -->
    <section class="single-post-hero">
        <div class="container">
            <!-- Breadcrumb -->
            <nav class="breadcrumb" aria-label="Breadcrumb">
                <a href="../index.html">Home</a>
                <span class="breadcrumb-separator">/</span>
                <a href="blog.html">Blog</a>
                <span class="breadcrumb-separator">/</span>
                <span class="breadcrumb-current">${title}</span>
            </nav>

            <header class="single-post-header">
                <span class="post-category" style="--cat-color: ${getCategoryColor(category)}">${categoryLabels[category]}</span>
                <h1>${title}</h1>

                <div class="single-post-meta">
                    <div class="single-post-author">
                        <img src="${author.avatar}" alt="${author.name}">
                        <div class="author-details">
                            <span class="name">${author.name}</span>
                            <span class="role">${author.role}</span>
                        </div>
                    </div>
                    <div class="single-post-date">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
                        <time datetime="${now}">${new Date().toLocaleDateString('it-IT', {day:'numeric',month:'long',year:'numeric'})}</time>
                        <span>•</span>
                        <span>${readingTime} min lettura</span>
                    </div>
                </div>
            </header>
        </div>
    </section>

    <!-- CONTENT -->
    <main id="main-content" class="single-post-content">
        <div class="container">
            <article class="article-wrapper">
                <!-- Hero Image -->
                ${articleData.heroImage ? `
                <figure class="hero-figure">
                    <img src="${articleData.heroImage.url}" alt="${imageAlt}" width="1200" height="675" loading="eager">
                    ${imageCaption ? `<figcaption>${imageCaption}</figcaption>` : ''}
                </figure>
                ` : ''}

                <!-- Article Body -->
                <div class="article-body">
                    ${htmlContent}
                </div>

                ${faqHtml}

                <!-- Share -->
                <div class="share-section">
                    <span>Condividi:</span>
                    <div class="share-buttons">
                        <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://www.attalgroup.it/pages/blog/${slug}.html" target="_blank" rel="noopener" class="share-btn" aria-label="Condividi su LinkedIn">
                            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
                        </a>
                        <a href="https://twitter.com/intent/tweet?url=https://www.attalgroup.it/pages/blog/${slug}.html&text=${encodeURIComponent(title)}" target="_blank" rel="noopener" class="share-btn" aria-label="Condividi su Twitter">
                            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/></svg>
                        </a>
                        <button class="share-btn" onclick="copyLink()" aria-label="Copia link">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg>
                        </button>
                    </div>
                </div>

                <!-- Author Box -->
                <aside class="author-box">
                    <img src="${author.avatar}" alt="${author.name}">
                    <div class="author-box-content">
                        <h3>${author.name}</h3>
                        <p class="author-role">${author.role}</p>
                        <p>${author.bio}</p>
                    </div>
                </aside>
            </article>
        </div>
    </main>

    <!-- Footer -->
    <div id="footer-placeholder"></div>

    <!-- Scripts -->
    <script>
        // Reading progress bar
        window.addEventListener('scroll', () => {
            const article = document.querySelector('.article-wrapper');
            if (!article) return;
            const rect = article.getBoundingClientRect();
            const scrollTop = window.scrollY;
            const docHeight = article.offsetHeight;
            const winHeight = window.innerHeight;
            const scrollPercent = (scrollTop / (docHeight - winHeight + rect.top + scrollTop)) * 100;
            document.getElementById('readingProgress').style.width = Math.min(100, Math.max(0, scrollPercent)) + '%';
        });

        // Copy link
        function copyLink() {
            navigator.clipboard.writeText(window.location.href);
            alert('Link copiato!');
        }
    </script>
    <script src="../../assets/js/attal-components.js"></script>
</body>
</html>`;

            // Show modal
            document.getElementById('htmlOutput').textContent = generatedHtml;
            document.getElementById('htmlModal').classList.add('show');
        }

        function getCategoryColor(category) {
            const colors = {
                'lavoro': '#e22721',
                'normative': '#0B8D84',
                'news-azienda': '#6366f1',
                'eventi': '#f59e0b',
                'consigli-candidati': '#ec4899',
                'per-aziende': '#3b82f6'
            };
            return colors[category] || '#6b7280';
        }

        // ============================================
        // MODAL & EXPORT
        // ============================================

        function closeModal() {
            document.getElementById('htmlModal').classList.remove('show');
        }

        function copyHtml() {
            navigator.clipboard.writeText(generatedHtml);
            showToast('HTML copiato negli appunti!');
        }

        function downloadHtml() {
            const slug = document.getElementById('articleSlug').value || 'articolo';
            const blob = new Blob([generatedHtml], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${slug}.html`;
            a.click();
            URL.revokeObjectURL(url);
            showToast('File HTML scaricato!');
        }

        function downloadJson() {
            const blob = new Blob([JSON.stringify(generatedJson, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'blog-post-entry.json';
            a.click();
            URL.revokeObjectURL(url);
            showToast('File JSON scaricato! Aggiungi questo contenuto a blog-posts.json');
        }

        // Close modal on escape
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeModal();
        });
    </script>

    <!-- Footer Standard -->
    <div id="footer-placeholder"></div>

    <!-- Components -->
    <script src="../../assets/js/attal-components.js"></script>
</body>
</html>
